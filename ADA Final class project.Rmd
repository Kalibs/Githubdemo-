---
title: "ADA Project"
author: "Georgewilliam Kalibbala"
date: "2024-10-21"
output:
  word_document: default
  html_document: default
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**I. TITLE: Association between Diabetes and Access to Healthy Foods
among Adults in New York City, 2020**

Examining the Role of Access to Healthy Foods in Modifying Diabetes Risk Among Adults in New York City, 2020.

**II. BACKGROUND** Diabetes remains a critical public health challenge
globally, especially in urban environments like New York City, where
environmental factors such as access to healthy foods play a critical
role in its prevalence.1,2 Reports indicate that over 1 million
residents in New York city suffer from diabetes.1–3 Studies also show
that limited access to affordable, nutritious foods commonly found in
“food deserts” is associated with higher rates of obesity, which is a
major risk factor for type 2 diabetes.3,4 Neighborhoods lacking fresh
produce while having abundant fast-food options often experience these
higher rates of obesity and diabetes, indicating that food access is
closely tied to health outcomes.5,6

Moreover, socioeconomic disparities play a crucial role in food access,
particularly in underserved communities, which experience
disproportionate rates of diabetes.4,5,7 Lower-income areas frequently
struggle with reduced access to healthy food, while wealthier areas have
better access to affordable, fresh produce, leading to better health
outcomes.6,8Therefore, addressing healthy food access issues could play
a significant role in diabetes prevention and management hence improving
public health outcomes.1,8–10

This study will examine the relationship between access to healthy foods
and diabetes prevalence among adults in New York City, using data from
the 2020 NYC Community Health Survey (CHS) to explore how variations in
food access across different neighborhoods impact diabetes rates.11

III. **OBJECTIVES Primary Objectives:**

a.  Examine whether access to healthy foods is associated with the
    prevalence of diabetes among adults in New York City in 2020.
b.  Analyze the relationship between Household income and diabetes
    prevalence across neighborhoods in New York City with varying access
    to healthy foods. Optional Secondary Objective
c.  Explore whether race/ethnicity modifies the association between
    access to healthy food and diabetes prevalence.


IV. **APPROACH**

a.  **Data Source** The study will utilize data from the New York City
    Community Health Survey (CHS) 2020, a cross-sectional survey
    conducted by the NYC Department of Health and Mental Hygiene. The
    CHS provides self-reported data on various health outcomes,
    including diabetes, as well as related social determinants such as
    food access and physical activity. The dataset is available publicly
    at NYC health portal, a community Health Survey Public Use Data
    page.12

b.  **Study Population** The study population will include adults in
    non-group quarters aged 18 and older residing in New York City, have
    a cellular telephone or live in a household with a landline
    telephone and participated in the 2020 CHS.13 Individuals with
    missing data on key variables, such as diabetes status or access to
    healthy food, will be excluded from the analysis.

c.  **Variables Dependent Variable:** Diabetes Status: Self-reported
    diabetes diagnosis (diabetes20, coded as 1 = Yes, 0 = No).
    Independent Variables: Access to Healthy Food: Coded as
    nutrition1(number of servings of fruits/vegetables consumed
    yesterday, treated as a continuous variable). Control Variables:
    Age: Coded as agegroup (grouped age categories). Sex: Coded as
    birthsex (biological sex). Race/Ethnicity: Coded as newrace
    (race/ethnicity). Household income: Code as imputed_povertygroup by
    household income means the combined income from everyone living in
    the household including even roommates or those on disability
    income.

d.  **Reproducibility Plan** The analysis will be conducted using a
    reproducible code in R studio, with all data cleaning, manipulation,
    and modeling steps documented and code annotated. A
    version-controlled repository will be maintained, ensuring
    transparency in coding and analysis procedures. The final R-scripts,
    data sets, and documentation will be stored in a publicly accessible
    repository on GitHub.

e.  **Statistical Analysis** The association between access to healthy
    foods and diabetes prevalence will be assessed using logistic
    regression models. 
    
    Model 1: Access to healthy food as the
    independent variable, with adjustments for confounders such as age,
    sex, race/ethnicity, and household income (poverty levels).
    
    Model 2:SES (household income) will be added as a covariate. 
    
    Interaction Terms: Test for potential interactions between food access and
    household income using interaction terms. 
    
    Stratified Analysis, Investigate effect modification by race/ethnicity using stratified
    analysis, comparing associations across racial/ethnic groups.
    Assumptions of logistic regression, including multicollinearity and goodness-of-fit, will be evaluated.
    
    V. APPENDICES References

1.  2024-diabetes-city-council-report.pdf. Accessed October 22, 2024.
    <https://www.nyc.gov/assets/doh/downloads/pdf/diabetes/2024-diabetes-city-council-report.pdf>
2.  diabetes_chart_book.pdf. Accessed October 22, 2024.
    <https://www.nyc.gov/assets/doh/downloads/pdf/epi/diabetes_chart_book.pdf>
3.  Testimony About NYC’s Efforts to Address the Diabetes Epidemic.
    Accessed October 22, 2024.
    <https://www.nycfoodpolicy.org/testimony-to-the-new-york-city-council-on-efforts-to-address-the-growing-diabetes-epidemic/>
4.  Walker RE, Keane CR, Burke JG. Disparities and access to healthy
    food in the United States: A review of food deserts literature.
    Health Place. 2010;16(5):876-884.
    <doi:10.1016/j.healthplace.2010.04.013>
5.  Hill-Briggs F, Adler NE, Berkowitz SA, et al. Social Determinants of
    Health and Diabetes: A Scientific Review. Diabetes Care.
    2021;44(1):258-279. <doi:10.2337/dci20-0053>
6.  Kirby JB, Bernard D, Liang L. The Prevalence of Food Insecurity Is
    Highest Among Americans for Whom Diet Is Most Critical to Health.
    Diabetes Care. 2021;44(6):e131-e132. <doi:10.2337/dc20-3116>
7.  databrief128.pdf. Accessed October 22, 2024.
    <https://www.nyc.gov/assets/doh/downloads/pdf/epi/databrief128.pdf>
8.  Seligman HK, Laraia BA, Kushel MB. Food Insecurity Is Associated
    with Chronic Disease among Low-Income NHANES Participants. J Nutr.
    2010;140(2):304-310. <doi:10.3945/jn.109.112573>
9.  Gucciardi E, Vahabi M, Norris N, Del Monte JP, Farnum C. The
    Intersection between Food Insecurity and Diabetes: A Review. Curr
    Nutr Rep. 2014;3(4):324-332. <doi:10.1007/s13668-014-0104-4>
10. Essien UR, Shahid NN, Berkowitz SA. Food Insecurity and Diabetes in
    Developed Societies. Curr Diab Rep. 2016;16(9):79.
    <doi:10.1007/s11892-016-0774-y>
11. Community Health Survey Public Use Data - NYC Health. Accessed
    October 22, 2024.
    <https://www.nyc.gov/site/doh/data/data-sets/community-health-survey-public-use-data.page>
12. Community Health Survey Public Use Data - NYC Health. Accessed
    October 22, 2024.
    <https://www.nyc.gov/site/doh/data/data-sets/community-health-survey-public-use-data.page>
13. Community Health Survey Methodology - NYC Health. Accessed October
    22, 2024.
    <https://www.nyc.gov/site/doh/data/data-sets/community-health-survey-methodology.page>

**Project Timeline**

Week 1-2: Data cleaning in R-studio, and initial exploratory analysis.

Week 3-4: Conduct descriptive statistics and initial regression
modeling.

Week 5-6: Finalize regression models, perform stratified analyses, and
test interaction terms.

Week 7: Compile results and prepare presentation materials.


# Defined a Directed Acyclic Graph (DAG) with nodes representing variables and directed edges indicating causal relationships between them.

# Code of the DAG
dag {
bb="0,0,1,1"
"Race/ethinicity" [pos="0.280,0.265"]
Age [pos="0.456,0.268"]
BMI [pos="0.533,0.053"]
Birthsex [pos="0.451,0.740"]
Diabetes [outcome,pos="0.790,0.550"]
Education [pos="0.644,0.801"]
Insurance [pos="0.768,0.255"]
Nutrition [exposure,pos="0.175,0.554"]
Poverty [pos="0.310,0.902"]
"Race/ethinicity" -> Education
"Race/ethinicity" -> Poverty
Age -> Diabetes
Age -> Insurance
Age -> Nutrition
BMI -> Diabetes
Birthsex -> Diabetes
Birthsex -> Nutrition
Education -> Insurance
Education -> Nutrition
Education -> Poverty
Insurance -> Diabetes
Nutrition -> BMI
Nutrition -> Diabetes
Poverty -> Nutrition
}

Abstract


```{r}
# Load and display the DAG image
library(magick)  
img <- image_read("DAG- ADA.png") 
print(img)
```



# Install packages and load libraries for figure 1 and table1

```{r}
# Install packages and load libraries for figure 1 and table1
pacman::p_load(tidyverse, readr, table1, DiagrammeR, rsvg, broom)
```

## Reading data from from the folder
```{r}
library(haven)
Diabetes <- read_sas("chs2020_public.sas7bdat")
```

## Getting the header of the dataframe
```{r}
head(Diabetes) 
```

## Selected and recorded variables of interest 
```{r}
library(dplyr)
Diabetes_sorted <- Diabetes %>%
  dplyr::select(diabetes20, agegroup6, birthsex, newrace6, insuredgateway20,bmi, 
         nutrition1, imputed_povertygroup, education)

```

## Cleaned the Diabetes dataset by recoding categorical variables, converting numeric variables, and dropping observations with missing data.
```{r}
library(dplyr)
Diabetes_Clean <- Diabetes_sorted %>%
  mutate(diabetes20 = recode_factor(diabetes20,
                                    `1` = "Yes",
                                    `2` = "No")) %>%
  drop_na(diabetes20) %>%
  mutate(birthsex = recode_factor(birthsex,
                                  `1` = "Male", 
                                  `2` = "Female")) %>%
  drop_na(birthsex) %>%
  mutate(agegroup6 = recode_factor(agegroup6, 
                                   `1` = "18-24",
                                   `2` = "25-29",
                                   `3` = "30-44",
                                   `4` = "45-64",
                                   `5` = "65-74",
                                   `6` = "75+")) %>%
  drop_na(agegroup6) %>%
  mutate(nutrition1 = as.numeric(nutrition1)) %>%
  drop_na(nutrition1) %>%
  mutate(bmi = as.numeric(bmi)) %>%
  drop_na(bmi) %>%
  mutate(newrace6 = recode_factor(newrace6,
                                  `1` = "White, non-Hispanic",
                                  `2` = "Black, non-Hispanic",
                                  `3` = "Hispanic",
                                  `4` = "Asian/PI, non-Hispanic",
                                  `5` = "N African/Mid Eastern, non-Hispanic",
                                  `6` = "Other, non-Hispanic")) %>%
  mutate(insuredgateway20 = recode_factor(insuredgateway20,
                                          `1` = "Yes",
                                          `2` = "No")) %>%
  drop_na(insuredgateway20) %>%
  mutate(imputed_povertygroup = recode_factor(imputed_povertygroup,
                                              `1` = "<100% poverty",
                                              `2` = "100% - <200% poverty",
                                              `3` = "200% - <400% poverty",
                                              `4` = "400% - <600% poverty",
                                              `5` = ">= 600% poverty")) %>%
  drop_na(imputed_povertygroup) %>%
  mutate(education = recode_factor(education,
                                   `1` = "Less than high school",
                                   `2` = "High school graduate",
                                   `3` = "Some college/technical school",
                                   `4` = "College graduate")) %>%
  drop_na(education)

```

## Created a flowchart with two nodes representing the starting number of records and the number after excluding observations with missing data.
```{r, echo=FALSE, eval=FALSE}
grViz(diagram = "digraph flowchart{

      node [fontname = Helvetica, shape = rectangle, fontsize=30, style=filled, fillcolor=lightblue, width=5, height=2] 
      
      node1 [label = '@@1'] # starting number
      node2 [label = '@@2'] # number after exclusion 1
      
      node1 -> node2
}
      [1]: 'Starting number of records in Diabetes dataframe n = 8,781'
      [2]: 'Excluding 605 observations with missing data from the variables (diabetes20, agegroup6, birthsex, newrace6, insuredgateway20, bmi, nutrition1, imputed_povertygroup, education) n = 8,176'")
```


## Create the table1 object with renamed variables
```{r}
table1(~ agegroup6 + birthsex + newrace6 + insuredgateway20 + education + nutrition1+ bmi + imputed_povertygroup | diabetes20, data = Diabetes_Clean)
```


## Model 1: Adjusting for Age, Birthsex, and Education

```{r}
# Logistic regression model with Age, Birthsex, and Education as confounders
model1 <- glm(diabetes20 ~ nutrition1 + agegroup6 + birthsex + education, data = Diabetes_Clean, family = binomial)

model1_summary <- tidy(model1, conf.int = TRUE)

# Displayed the summary in a table
model1_summary

```


```{r}

# Fit the logistic regression model
model2 <- glm(diabetes20 ~ nutrition1 + agegroup6 + birthsex + insuredgateway20, data = Diabetes_Clean, family = binomial)


model_summary <- tidy(model2, conf.int = TRUE)

# Displayed the summary in a table
model_summary

```

## Modal Comparison using the Akaike Information Criterion (AIC) to asses model fit

```{r}
# Comparing models using AIC
AIC(model1, model2)

```
Since Model 1 had a lower AIC (5296.5 compared to 5414.6), it was the preferred model in terms of AIC-based model selection. This suggests that Model 1 achieves a better trade-off between explanatory power and complexity, making it a more efficient choice for predicting diabetes outcomes in this dataset.
